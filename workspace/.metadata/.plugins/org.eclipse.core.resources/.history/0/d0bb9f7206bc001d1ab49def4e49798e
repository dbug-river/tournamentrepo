package com.rivertech.console;

import com.rivertech.repositories.DatawarehouseRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class EtlConsole {

	public static void main(String[] args) {
		final Logger logger = LoggerFactory.getLogger(EtlConsole.class);
		
		string url = "jdbc:clickhouse://127.0.0.1:8123";
        String username = "default";
        String password = "omar123";
           
        
		DatawarehouseRepository repo = 
				new DatawarehouseRepository(url, username, password);
		
		logger.info("Flag staging rows as dw_status = 1");
		repo.FlagStagingForProcess();
		
		logger.info("Update game dimension");
		repo.UpdateGameDimension();
		
		logger.info("Update time dimension");
		repo.UpdateTimeDimension();
		
		logger.info("Update user dimension");
		repo.UpdateUserDimension();;
		
		logger.info("Update fact table");
		repo.UpdateFactTable();
		
		logger.info("Flag staging rows as dw_status = 2");
		repo.FlagStagingProcessed();
		
		logger.info("Ready");
	}

}
