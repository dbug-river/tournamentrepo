package com.rivertech.repositories;



public class DimensionRepository extends Repository {

	public DimensionRepository(String url, String username, String password) {
		super(url, username, password);
	}
	
	public void FlagStagingForProcess() {
		String query  =  "ALTER TABLE Staging_GameRound "
					   + "UPDATE dw_status = 1 "
					   + "WHERE dw_status = 0; ";
		super.Execute(query);
	}
	
	public void UpdateGameDimension() {
		String query  = "INSERT INTO DW_GameDimension "
						+ "	SELECT "
						+ "	DISTINCT game_id, "
						+ "			 game_name, "
						+ "			 provider "
						+ "	FROM "
						+ "		Staging_GameRound "
						+ "	WHERE "
						+ "		dw_status = 1;";
		super.Execute(query);
		super.Execute("OPTIMIZE TABLE DW_GameDimension");
	}


}
